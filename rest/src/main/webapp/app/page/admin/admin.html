<!-- Controlled by AdminCtrl (in adminController.js)  -->
<div class="row">

  <!-- Content -->
  <div class="col-md-12 col-xs-12">
  <h4>Application Administration  </h4>
    <accordion ng-show="user.applicationRole == 'ADMIN'" > 
    <accordion-group heading="Application Administration" 
    is-open="false">
     <!-- Projects --> <accordion-heading>
    <h5>
      <span tooltip-placement="right" tooltip="List of the projects.">
        Projects </span>
    </h5>
    </accordion-heading>
    <div class="col-md-12 col-xs-12">
      <h4>
        <div style="float: right;">
          <a title="Create new project" ng-click="openNewProjectModal(lproject)">
            <i class="glyphicon glyphicon-plus"></i>
          </a>
        </div>
      </h4>
      
        <span style="display: block;">
          <pagination items-per-page="projectsPageSize" max-size="5"
            boundary-links="true" class="pagination-sm" previous-text="&lsaquo;"
            next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
            ng-show="pagedProjects.totalCount > projectsPageSize || projectPaging.filter"
            total-items="pagedProjects.totalCount"
            ng-model="projectPaging.page"
            ng-change="retrievePagedProjects()"></pagination>

          <input class="input-filter" placeholder="Enter filter text"
            ng-show="pagedProjects.totalCount > projectsPageSize || projectPaging.filter"
            type="text" ng-model="projectPaging.filter"
            ng-model-options="{ debounce: 300 }"
            ng-change="retrievePagedProjects()">

          <button class="btn btn-xs btn-warning"
            ng-show="projectPaging.filter"
            ng-click="projectPaging.filter = ''; retrievePagedProjects()"
            title="Click to clear filter text">Clear</button>
        </span>
      
      
      <table class="table">
        <thead>
          <th class="col-md-2 col-xs-2">Id</th>
          <th class="col-md-8 col-xs-8">Name</th>
          <th class="col-md-1 col-xs-1">&nbsp;</th>
          <th class="col-md-1 col-xs-1">&nbsp;</th>
        </thead>
        <tbody>
          <tr ng-repeat="project in pagedProjects">
            <td>{{project.id}}</td>
            <td><a ng-click="project.isExpanded = !project.isExpanded">
                [ <i
                  ng-class="{'glyphicon-minus': project.isExpanded, 'glyphicon-plus': !project.isExpanded}"></i>
                ]
              </a>{{project.name}}
              <div collapse="!project.isExpanded">{{project.description}}</div></td>

            <td><a title="Edit"
                ng-click="openEditProjectModal(project); $event.stopPropagation()">
                <i class="glyphicon glyphicon-pencil"></i>
              </a></td>

            <td><a title="Remove"
                ng-click="remove('project',project,projects); $event.stopPropagation()">
                <i class="glyphicon glyphicon-remove"></i>
              </a></td>
          </tr>
        </tbody>
      </table>
    </div>
    <!--  end Projects -->
    </accordion-group>
    <accordion-group> <!-- Users --> <accordion-heading>
    <h5>
      <span tooltip-placement="right" tooltip="List of the users and their application roles.">
        Users </span>
    </h5>
    </accordion-heading>
    <div class="col-md-12 col-xs-12">
      <h4>
        <div style="float: right;">
          <a title="Create new user" ng-click="openNewUserModal(luser)">
            <i class="glyphicon glyphicon-plus"></i>
          </a>
        </div>
      </h4>
      <table class="table">
        <thead>
          <th class="col-md-2 col-xs-2">Username</th>
          <th class="col-md-3 col-xs-3">Name</th>
          <th class="col-md-3 col-xs-3">Email</th>
          <th class="col-md-2 col-xs-2">Application Role</th>
          <th class="col-md-1 col-xs-1">&nbsp;</th>
          <th class="col-md-1 col-xs-1">&nbsp;</th>
        </thead>
        <tbody>
          <tr ng-repeat="user in users">
            <td>{{user.userName}}</td>
            <td>{{user.name}}</td>
            <td>{{user.email}}</td>
            <td>{{user.applicationRole}}</td>
            
            <td><a title="Edit"
                ng-click="openEditUserModal(user); $event.stopPropagation()">
                <i class="glyphicon glyphicon-pencil"></i>
              </a></td>

            <td><a title="Remove"
                ng-click="remove('user',user,users); $event.stopPropagation()">
                <i class="glyphicon glyphicon-remove"></i>
              </a></td>
          </tr>
        </tbody>
      </table>
    </div>
    <!--  end Users -->
    </accordion-group>
    </accordion>

    <h4>User & Project Management</h4>
    <div id="rcorners2"  class="col-md-6 col-xs-12">
      <table class="table">
        <h5>Project List</h5>
        <thead>
          <th class="col-md-1 col-xs-1">Id</th>
          <th class="col-md-5 col-xs-5">Name</th> 
          <th class="col-md-6 col-xs-6">Description</th>         
        </thead>
        <tbody>
          <tr ng-repeat="project in projects" ng-click="setProject(project)">
            <td ng-class="{selected: project.id === selectedProject.id}">{{project.id}}</td>
            <td ng-class="{selected: project.id === selectedProject.id}">{{project.name}}</td>
            <td ng-class="{selected: project.id === selectedProject.id}">{{project.description}}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div  id="rcorners2"  class="col-md-6 col-xs-12">
      <h5>Project User Selection & Role Assignment</h5>

      <input type="text" ng-model="searchParams.query"
        placeholder="Enter user search terms">

      <button class="btn btn-sm btn-primary" type="submit"
        ng-click="searchParams.page = 1 && findUsers()">Search</button>
      <table class="table">
        <thead>
          <th class="col-md-5 col-xs-5">Name</th>
          <th class="col-md-4 col-xs-4">UserName</th>
          <th class="col-md-2 col-xs-2">Project Role</th>
          <th class="col-md-1 col-xs-1">&nbsp;</th>
        </thead>
        <tbody>
          <tr ng-repeat="user in userResults">
            <td>{{user.name}}</td>
            <td>{{user.userName}}</td>
            <td><select ng-model="user.projectRole"
              ng-options="item for item in projectRoles"></select></td>
            <td><a title="Add user to project with selected role." ng-init="user.projectRole='AUTHOR'"
                ng-click="assignUserToProject(selectedProject.id, user.userName, user.projectRole)">
            <i class="glyphicon glyphicon-plus"></i>
                </a></td>
          </tr>
        </tbody>
      </table>

    </div>

    <div  id="rcorners2"  class="col-md-6 col-xs-12">
      <h5>Project Users</h5>
      <table class="table">
        <thead>
          <th class="col-md-5 col-xs-5">Name</th> 
          <th class="col-md-5 col-xs-5">UserName</th> 
          <th class="col-md-2 col-xs-2">Project Role</th> 
          <th class="col-md-1 col-xs-1">&nbsp;</th>       
        </thead>
        <tbody>
          <tr ng-repeat="(key, value) in selectedProject.projectRoleMap.entry">
            <td>{{value.key.name}}</td>
            <td>{{value.key.userName}}</td>
            <td>{{value.value}}</td>
            <td><a title="Unassign"
                ng-click="unassignUserFromProject(selectedProject.id, value.key.userName);">
                <i class="glyphicon glyphicon-remove"></i>
              </a></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>